<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <!-- Meta tags for social media banners, these should be filled in appropriatly as they are your "business card" -->
  <!-- Replace the content tag with appropriate information -->
  <meta name="description" content="DESCRIPTION META TAG">
  <meta property="og:title" content="CellularLint"/>
  <meta property="og:description" content="CelluarLint-Usenix Security 2024"/>
  <meta property="og:url" content="URL OF THE WEBSITE"/>
  <!-- Path to banner image, should be in the path listed below. Optimal dimenssions are 1200X630-->
  <meta property="og:image" content="static/image/your_banner_image.png" />
  <meta property="og:image:width" content="1200"/>
  <meta property="og:image:height" content="630"/>


  <meta name="twitter:title" content="TWITTER BANNER TITLE META TAG">
  <meta name="twitter:description" content="TWITTER BANNER DESCRIPTION META TAG">
  <!-- Path to banner image, should be in the path listed below. Optimal dimenssions are 1200X600-->
  <meta name="twitter:image" content="static/images/your_twitter_banner_image.png">
  <meta name="twitter:card" content="summary_large_image">
  <!-- Keywords for your paper to be indexed by-->
  <meta name="keywords" content="KEYWORDS SHOULD BE PLACED HERE">
  <meta name="viewport" content="width=device-width, initial-scale=1">


  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="static/css/boxstyles.css">


  <title>CellularLint</title>
  <link rel="icon" type="image/x-icon" href="static/images/favicon.ico">
  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
  rel="stylesheet">

  <link rel="stylesheet" href="static/css/bulma.min.css">
  <link rel="stylesheet" href="static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="static/css/index.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
  <script defer src="static/js/fontawesome.all.min.js"></script>
  <script src="static/js/bulma-carousel.min.js"></script>
  <script src="static/js/bulma-slider.min.js"></script>
  <script src="static/js/index.js"></script>
</head>
<body>


  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <h1 class="title is-1 publication-title">CellularLint: A Systematic Approach to Identify Inconsistent Behavior in Cellular Network Specifications</h1>
            <div class="is-size-5 publication-authors">
             
              <span class="author-block">
                <a href="https://www.mirzamr.net/" target="_blank">Mirza Masfiqur Rahman</a><sup>*</sup>,</span>
                <span class="author-block">
                  <a href="https://www.imtiazkarim.net/" target="_blank">Imtiaz Karim</a><sup>*</sup>,</span>
                  <span class="author-block">
                    <a href="https://www.cs.purdue.edu/homes/bertino/" target="_blank">Elisa Bertino</a>
                  </span> 
                  </div>
                  <div class="is-size-5 publication-authors">
                    <span class="author-block">Purdue University</span>
                    <span class="eql-cntrb"><small><br><sup>*</sup>Equal contribution. The student author's name is given first.</small></span>
                  </div> 

                  <div class="column has-text-centered">
                    <div class="publication-links">
                         <!-- Arxiv PDF link -->
                      <span class="link-block">
                        <a href="https://www.usenix.org/conference/usenixsecurity24/presentation/rahman" target="_blank"
                        class="external-link button is-normal is-rounded is-dark">
                        <span class="icon">
                          <i class="fas fa-file-pdf"></i>
                        </span>
                        <span>Paper</span>
                      </a>
                    </span>

                    <!-- Supplementary PDF link -->
                    <span class="link-block">
                      <a href="static/pdfs/CellularLint_USENIX_Security_24_Final_Artifact_Appendix.pdf" target="_blank"
                      class="external-link button is-normal is-rounded is-dark">
                      <span class="icon">
                        <i class="fas fa-file-pdf"></i>
                      </span>
                      <span>Supplementary</span>
                    </a>
                  </span>

                  <!-- Github link -->
                  <span class="link-block">
                    <a href="https://github.com/CellularLint/cellularlint-codes" target="_blank"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fab fa-github"></i>
                    </span>
                    <span>Code</span>
                  </a>
                </span>

                <!-- ArXiv abstract Link -->
                <span class="link-block">
                  <a href="https://arxiv.org/abs/2407.13742" target="_blank"
                  class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                    <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>


<!-- Teaser video-->
<!-- <section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <video poster="" id="tree" autoplay controls muted loop height="100%">
        <source src="static/videos/banner_video.mp4"
        type="video/mp4">
      </video>
      <h2 class="subtitle has-text-centered">
        Aliquam vitae elit ullamcorper tellus egestas pellentesque. Ut lacus tellus, maximus vel lectus at, placerat pretium mi. Maecenas dignissim tincidunt vestibulum. Sed consequat hendrerit nisl ut maximus. 
      </h2>
    </div>
  </div>
</section> -->
<!-- End teaser video -->

<!-- Paper abstract -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            In recent years, there has been a growing focus on scrutinizing the security of cellular networks, often attributing security vulnerabilities to issues in the underlying protocol design descriptions. 
            These protocol design specifications, typically extensive documents that are thousands of pages long, can harbor inaccuracies, underspecifications, implicit assumptions, and internal inconsistencies.
            In light of the evolving landscape, we introduce CellularLint - a semi-automatic framework for inconsistency detection within the standards of 4G and 5G, capitalizing on a suite of natural language processing techniques. 
            Our proposed method uses a revamped few-shot learning mechanism on domain-adapted large language models. Pre-trained on a vast corpus of cellular network protocols, this method enables CellularLint to simultaneously detect inconsistencies at various levels of semantics and practical use cases. 
            In doing so, CellularLint significantly advances the automated analysis of protocol specifications in a scalable fashion.  In our investigation, we focused on the Non-Access Stratum (NAS) and the security specifications of 4G and 5G networks, ultimately uncovering 157 inconsistencies with 82.67% accuracy. 
            After verification of these inconsistencies on 3 open-source implementations and 17 commercial devices, we confirm that they indeed have a substantial impact on design decisions, potentially leading to concerns related to privacy, integrity, availability, and interoperability.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End paper abstract -->


<!-- Image carousel -->
<section class="hero is-small">
  <div class="hero-body">
    <div class="container">
      <!--<div id="results-carousel" class="carousel results-carousel">-->
       <div class="item">
        <img src="static/images/overview.png" alt="CellularLint Framework"/>
        <h3 class="subtitle has-text-centered">
          Framework Overview
        </h3>
        </div>
      <!--</div>-->
    </div>
  </div>
</section>
<!-- End image carousel -->

<!-- NAS Message Ciphering -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">1. NAS Message Ciphering</h2>
        <div class="content has-text-justified">
          <p>
            <b>Finding:</b> After the completion of security mode procedures, 
            the specifications suggest that, except for a few messages, all messages should be integrity-protected
            and ciphered. However, on two occasions (shown in Figure 6), it is emphasized that 
            all messages after the security procedure should be integrity-protected and ciphered. Failure 
            to enforce integrity and ciphering is a serious design flaw 
            and can leave implementations subject to vulnerabilities and 
            interoperability issues.
          </p>
          <div class="custom-box">
            <div class="custom-text-block">
                <p>T<sub>1</sub>: From this time onward the UE shall cipher and integrity protect all NAS
                signalling messages with the selected NAS ciphering and NAS integrity algorithms.
                </p>
            </div>
            <div class="custom-text-block">
                <p>T<sub>2</sub>: From this time onward, all NAS messages exchanged between the UE and
                  the MME are sent integrity protected and except for the messages specified in
                  clause 4.4.5, all NAS messages exchanged between the UE and the MME are
                  sent ciphered
                </p>
            </div>
          </div>
          <p>
            <b>Inconsistency to exploit:</b> In the case of T<sub>1</sub>, the specification 
            states after the security context has been established, the UE
            shall cipher and integrity protect all NAS signaling messages
            with selected NAS ciphering and integrity algorithms.
            However, T<sub>1</sub> does not mention the scenarios where the UE
            accepts plain-text messages. On the contrary, T<sub>2</sub> is more
            lucid and explicitly mentions such scenarios. Due to this
            inconsistency of not explicitly mentioning exception cases, an
            implementation might accept unexpected plain-text messages
            even after the security context is established. Therefore, we
            design an attack based on this scenario.
            Attack. For the attack, the adversary connects with a
            victim UE through a fake base station to send plain-text 
            identity_request or authentication_request [53].
            Similarly, the attacker can overshadow downlink packets to
            create plain-text messages. The affected UE accepts, processes and responds to the messages.
          </p>
          <p>
            <b>Investigation:</b> In open-source implementations, we found all
            implementations accepting plain-text authentication and
            identity requests even after the security context has been
            established. On the other hand, on commercial UEs, we found
            4 UEs accepting and responding to such plain-text messages
            (Table 6). Interestingly, for a very recent UE (Google Pixel
            7a, 2023), plain-text authentication_request is accepted,
            whereas plain-text identity_request is not accepted. This
            is another interesting scenario where vendors try to implement
            different behaviors for different exception case messages.
            Impact. The impact of accepting plain-text or integrity-failed
            NAS messages can be catastrophic and can be exploited by
            attackers to fingerprint users, traceability, and denial of service
            attacks. Note that DoLTEst [53] also reports several UEs
            accepting unprotected messages after the security context
            has been established, albeit from the implementation testing
            perspective. We, on the other hand, show that this issue in
            different implementations can be traced to the inconsistent
            behavior defined in the standards.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End NAS Message Ciphering -->

<!-- Condition Over Integrity Check -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">2. Condition Over Integrity Check</h2>
        <div class="content has-text-justified">
          <p>
            <b>Finding:</b> On many occasions, the UE sets the counter for 
            "SIM/USIM considered for GPRS/non-GPRS/5GS services" to implement
            a specific maximum value (Figure 7). While this flexibility is acceptable
            and standard practice, the precondition to check the integrity
            of the received message is often neglected.
          </p>
          <div class="custom-box">
            <div class="custom-text-block">
                <p>T<sub>1</sub>: The UE shall consider the USIM as invalid for EPS services and 
                  non-EPS services until switching off or the UICC containing the USIM is removed 
                  or the timer T3245 expires as described in clause 5.3.7a. 
                  Additionally, the UE shall delete the list of equivalent PLMNs and enter state EMM-
                  DEREGISTERED.NO-IMSI. If the message has been successfully integrity 
                  checked by the NAS and the UE maintains a counter for "SIM/USIM
                  considered invalid for GPRS services", then the UE shall set this counter to UE
                  implementation-specific maximum value.
                </p>
            </div>
            <div class="custom-text-block">
                <p>T<sub>2</sub>: The UE shall consider the USIM as invalid for EPS 
                  services until switching off or the UICC containing 
                  the USIM is removed or the timer T3245 expires as
                  described in clause 5.3.7a. The UE shall delete the list of equivalent PLMNs
                  and shall enter the state EMM-DEREGISTERED.NO-IMSI. If the UE maintains 
                  a counter for "SIM/USIM considered invalid for GPRS services", then
                  the UE shall set this counter to UE implementation-specific maximum value.
                </p>
            </div>
          </div>
          <p>
            <b>Inconsistency to exploit:</b> In the case of T<sub>1</sub>, the protocol specifies 
            successful integrity checking by the NAS. However, in
            T<sub>2</sub>, this integrity checking is skipped. These PoS are related to
            attach_reject and detach_request. However, we have
            also found instances of network-initiated detach_request,
            where there are inconsistencies. As the inconsistency is related
            to the integrity checking of messages, the attack steps and impact are the same as finding 1.
          </p>
          <p>
            <b>Investigation:</b> In the case of open-source implementation, 
            we see that all the open-source implementations in both 4G and 5G are vulnerable.
            However, in the case of commercial UEs, there were no instances of vulnerable behavior.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End Condition Over Integrity Check -->


<!-- Integrity check failure -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">3. Integrity check failure</h2>
        <div class="content has-text-justified">
          <p>
            <b>Finding:</b> We found two conflicting PoS where different statements are found for failed integrity
            checks of the control plane messages (Figure 8). Following
            this PoS to 4G security specification, ultimately, we found
            three (one segment is common) instances of different statements.
            Two of them clearly suggest that messages that have faulty
            MAC should be discarded, whereas the third one directs to a
            slightly flexible strategy suggesting the processing
            of certain messages even if they fail integrity checks.
          </p>
          <div class="custom-box">
            <div class="custom-text-block">
                <p>T<sub>1</sub>: In case of failed integrity check (i.e. faulty or missing MAC-I) is detected
                  after the start of integrity protection, the concerned message shall be discarded.
                  This can happen on the UE side or on the eNB side.
                </p>
            </div>
            <div class="custom-text-block">
                <p>T<sub>2</sub>: In case of failed integrity check (i.e. faulty or missing NAS-MAC) is
                  detected after the start of NAS integrity protection the concerned message shall
                  be discarded except for some NAS messages specified in TS 24.301 [9]. For
                  those exceptions the MME shall take the actions · · · NAS message with faulty
                  or missing NAS-MAC.
                </p>
            </div>
          </div>
          <p>
            <b>Inconsistency to exploit:</b>  In T<sub>1</sub>, whenever there are some 
            exceptional NAS messages that can trigger further MME actions,
            even with failed integrity, the specification mentions that.
            However, in T<sub>2</sub> for RRC, it does not specify such exceptional
            cases, though such exceptional cases exist, for instance, when
            RRC_connection_resume fails an integrity check, rather
            than just discarding, there are further steps. Through further
            manual analysis, we find these cases are not mentioned in
            the TS 33.501 (Security Architecture and Procedures for 5G
            Systems) specification, but in TS 38.331 (RRC Specification),
            which were not included in the scope of CellularLint. In a
            practical scenario, an implementor would use the RRC specification
            first, which clearly states exceptional messages with
            failed integrity. But later on, when the security specifications
            would be taken into account, the implementor would find it
            confusing with a more strict description. There is a possibility
            that such inconsistency may not directly result in vulnerabilities. 
            Still, it may cause differing implementations as both
            specifications cannot be logically taken into consideration
            at the same time. Hence, some implementations might not
            properly follow the integrity failing scenarios.
          </p>
          <p>
            <b>Investigation:</b> In open-source implementations, we found
            1 implementation accepting integrity-failed messages. On 
            the contrary, in commercial UEs, none of the UEs accept
            control-plane messages with failed integrity. However, in our
            investigation, we found another interesting behavior: 16 UEs
            dropped the connection after receiving an RRC packet with
            failed integrity, whereas 1 UE did not (Table 6). These inconsistent
            UE behaviors can be traced back to T<sub>2</sub>, which does not
            properly specify the exception cases and what to do in such scenarios.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End Integrity check failure -->


<!-- NCC reusage -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">4. NCC Reusage</h2>
        <div class="content has-text-justified">
          <p>
            <b>Finding:</b> We found a conflicting PoS in the 
            5G Security specification where two different conditions are
            expressed for the validity of the Next hop Chaining Counter
            (NCC) (shown in Figure 9). NCC is used for cryptographic
            derivation of the AS security algorithms and, hence, is a very
            important identifier. One segment dictates that the NCC value
            has to be fresh and previously unused to be accepted. On the
            contrary, the other segment claims that the only condition for
            acceptance is that the NCC value has to be different.
          </p>
          <div class="custom-box">
            <div class="custom-text-block">
                <p>T<sub>1</sub>: If the sent NCC value is fresh and belongs to an unused pair of NCC,
                  NH, the gNB shall save the pair of {NCC, NH} in the current UE AS security
                  context and shall delete the current AS key K<sub>gNB</sub>.
                </p>
            </div>
            <div class="custom-text-block">
                <p>T<sub>2</sub>: The UE shall take the received NCC value and save it as stored NCC... .
                  If the stored NCC value is different from the NCC value associated with the
                  current K<sub>gNB</sub>, the UE shall delete the current AS key K<sub>gNB</sub>.
                </p>
            </div>
          </div>
          <p>
            <b>Implication:</b> NCC and NH are critical parameters that are
            used to establish AS security and derive K<sub>gnb</sub>. These parameters are used
            during the RRC_Reestablish procedure to
            re-establish the RRC connection. This procedure is particularly
            important during handover. The expectation is that these
            session key creation parameters (NCC and NH) would be
            fresh and unused to create diverse keys (precisely described
            in T<sub>1</sub>). This is an important assumption ensuring forward and
            future secrecy guarantees of the keys. Forward and future
            secrecy ensures that the protocol defends the past and future
            sessions even if the current session is compromised [16].
            These parameters are essentially used as nonces to ensure the
            diversification of the keys. However, if the fresh and unused
            NCC/NH value usage is not mandated, then the forward and
            future secrecy guarantees can be broken. Furthermore, as the
            RRC_Reestablish message (containing these parameters) is
            unencrypted, the attacker can easily detect the sessions where
            the same NCC/NH values are used for key derivation.
          </p>
          <p>
            <b>Investigation:</b>  We found that none of the open-source implementations
            properly check these parameters and just accept if they differ from the previously accepted ones.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End NCC reusage -->


<!-- GUTI deletion -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">5. GUTI Deletion</h2>
        <div class="content has-text-justified">
          <p>
            <b>Finding:</b> On many occasions, when a reject
            message is received from the network, the UE updates
            its EPS/5GS status, clears the context, and subsequently
            moves to a deregistered state. We observe that in many
            cases, a rejection cause TC in a reject message RM would
            suggest the UE to clear the context and move to deregistered
            state while the same cause TC would keep the UE in registered
            state without clearing the security context (shown in Figure 10).
            For example, 5GM cause #13 received through registration_reject
            suggests the UE to delete GUTI, TAI, ngKSI while the same cause 
            received through tau_reject or service_reject message would keep the
            UE in a registered state without deleting the context. A cross-examination
            may suggest that since the messages are different, the same cause
            may trigger different behavior. However, other
            cause values such as #12 (tracking area not allowed) trigger
            similar behavior and state transition for different reject messages.
            Thus, it concretely verifies the conflicting suggestions about security context.
          </p>
          <div class="custom-box">
            <div class="custom-text-block">
                <p>T<sub>1</sub>: #13 (Roaming not allowed in this tracking area) 
                  The UE shall set the 5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it according
                  to subclause 5.1.3.2.2) and shall delete 5G-GUTI, last visited registered TAI, TAI list and ngKSI.
                </p>
            </div>
            <div class="custom-text-block">
                <p>T<sub>2</sub>: #13 (Roaming not allowed in this tracking area) The UE shall set the
                  5GS update status to 5U3 ROAMING NOT ALLOWED (and shall store it
                  according to subclause 5.1.3.2.2) and shall delete the list of equivalent PLMNs (if available).
                </p>
            </div>
          </div>
          <p>
            <b>Inconsistency to Exploit:</b> GUTI (Globally Unique Temporary ID)
            is a kind of temporary ID used to identify UEs. Each UE has a couple
            of different kinds of unique IDs, like IMSI, IMEI, etc.
            These sorts of temporary identifiers, like GUTI, are used to prevent 
            attackers from tracking users. However, if these identifiers are not changed or reset, 
            this can cause several privacy issues. An adversary can utilize old GUTI to
            track a UE through a linkability attack, violating privacy [32].
          </p>
          <p>
            <b>Investigation:</b> In commercial UEs, we found a total of 16 devices not properly
            deleting GUTI for these reject messages (Table 6). One recent UE (Apple iPhone 12 Pro),
            however, deletes the security context with GUTI after receiving service_reject.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End GUTI deletion -->


<!-- TAU and detach collision -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">6. TAU and Detach Collision</h2>
        <div class="content has-text-justified">
          <p>
            <b>Finding:</b> We found a PoS of conflicting directions 
            when TAU and detach procedure collide (shown in Figure 11).
            The first one states that the tracking_area_update procedure
            shall be aborted and the detach procedure shall be progressed. 
            On the other hand, the second segment states that the detach 
            procedure shall be aborted and re-initiated while the 
            tracking_area_update procedure is fully performed.
          </p>
          <div class="custom-box">
            <div class="custom-text-block">
                <p>T<sub>1</sub>: Tracking area updating and detach procedure collision 
                  EPS detach containing detach type "re-attach required" 
                  or "re-attach not required": If the UE receives a DETACH REQUEST message 
                  before the tracking area updating procedure has been completed, the tracking area updating
                  procedure shall be aborted and the detach procedure shall be progressed.
                </p>
            </div>
            <div class="custom-text-block">
                <p>T<sub>2</sub>: If a cell change into a new tracking area 
                  that is not in the stored TAI list occurs before the UE initiated 
                  detach procedure is completed, the UE proceeds as follows: 
                  1) If the detach procedure was initiated for reasons other 
                  than removal of the USIM or the UE is to be switched off, the detach procedure shall
                  be aborted and re-initiated after successfully performing a tracking area updating procedure.
                </p>
            </div>
          </div>
          <p>
            <b>Inconsistency to Exploit:</b> An attacker can achieve
            downgrade/denial-of-service by injecting detach_request 
            through fake-base-stations or signal-injection attacks [34]. In
            this case, an implementation that aims to implement both
            scenarios can exacerbate the situation by creating a deadlock
            state. As the statements are mutually exclusive either way,
            an implementation violates the specification. In our investigation
            of commercial implementation, we found all the UEs
            progress with the tracking_area_update procedure when
            such collision occurs (Table 6).
          </p>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End TAU and detach collision -->


<!-- Sub-state transition confusion -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">7. Sub-state Transition Confusion</h2>
        <div class="content has-text-justified">
          <p>
            <b>Finding:</b> When attach_reject message is received with the emm
            cause #14, the 4G specification has differing state transition
            descriptions (shown in Figure 1). This certainly can cause
            confusion in implementation design.
          </p>
          <div class="custom-box">
            <div class="custom-text-block">
                <p>T<sub>1</sub>: Whenever an ATTACH REJECT message with the EMM cause #14 "EPS
                  services not allowed in this PLMN" is received by the UE · · · 
                  Additionally the attach attempt counter shall be reset when the UE is in substate
                  EMMDEREGISTERED.ATTEMPTING-TO-ATTACH.
                </p>
            </div>
            <div class="custom-text-block">
                <p>T<sub>2</sub>: #14 (EPS services not allowed in this PLMN); The UE shall set the EPS
                  update status to EU3 ROAMING NOT ALLOWED · · · the UE shall reset the
                  attach attempt counter and enter the state EMM-DEREGISTERED.PLMN-SEARCH.
                </p>
            </div>
          </div>
          <p>
            <b>Investigation:</b> While looking further into open-source implementations,
            we found a very interesting scenario regarding this. In srsRAN, we see that 
            the developers tried to implement both of them. We show the code snippet of srsRAN
            in Figure 12. Here, we can see that both of the conditional statements contain the 
            same cause (lines 1 and 6) but have different sub-state transitions (lines 3 and 7).
            Of course, UE will go to the EMM_DEREGISTERED.PLMN_SEARCH sub-state due to the obscurity
            of the first "if". Such conflicts can potentially cause interoperability issues, 
            leaving a possibility for further synchronization problems.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End Sub-state transition confusion -->


<!-- Registration counter reset -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">8. Registration Counter Reset</h2>
        <div class="content has-text-justified">
          <p>
            <b>Finding:</b> When a UE receives a registration_reject message with 
            several cause such as #11 (PLMN not allowed) it resets the registration attempt counter.
            For the same cause value received through service_reject message, the UE should reset the 
            associated service request attempt counter. However, this directive is missing in the specification,
            although in the same 5G NAS specification, the general guideline for service_reject with a list of causes
            clearly suggests resetting the counter. Failure to clarify this in corresponding cause descriptions 
            has an impact on interoperability as some implementations take the general guideline into account 
            while others focus on specific scenarios.
          </p>
          <div class="custom-box">
            <div class="custom-text-block">
                <p>T<sub>1</sub>: #73 (Serving network not authorized). ... 
                  The UE shall delete the list of equivalent PLMNs,
                  shall reset the registration attempt counter. For
                  3GPP access the UE shall enter the state 5GMM-DEREGISTERED.PLMN-SEARCH, and for 
                  non-3GPP access the UE shall enter state 5GMM-DEREGISTERED.LIMITED-SERVICE. The UE
                  shall store the PLMN identity in the forbidden PLMN
                  list as specified in subclause 5.3.13A and if the UE
                  is configured to use timer T3245 then the UE shall
                  start timer T3245 and proceed as described in clause 5.3.19a.1.
                </p>
            </div>
            <div class="custom-text-block">
                <p>T<sub>2</sub>: #73 (Serving network not authorized). ... The UE shall
                  delete the list of equivalent PLMNs and store the PLMN
                  identity in the forbidden PLMN list as specified in subclause 5.3.13A 
                  and if the UE is configured to use timer
                  T3245 then the UE shall start timer T3245 and proceed as described in clause 5.3.19a.1.
                </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End Registration counter reset -->


<!-- Timer expiry as a precondition -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">9. Timer Expiry as a Precondition</h2>
        <div class="content has-text-justified">
          <p>
            <b>Finding:</b> When a registration_reject is received in case of 5G Standalone Non-Public Network (SNPN),
            the "list of subscriber data" is considered invalid until switch off or entry update or timer T3245 expiration.
            However, the authentication_reject under same condition does not consider the time T3245 expiry for the
            list validity. This is another conundrum causing interoperability issues.
          </p>
          <div class="custom-box">
            <div class="custom-text-block">
                <p>T<sub>1</sub>: In case of SNPN, if the UE is neither registered for 
                  onboarding services in SNPN nor performing initial registration for 
                  onboarding services in SNPN and the UE
                  supports access to an SNPN using credentials from a credentials holder,
                  the UE shall consider the selected entry
                  of the "list of subscriber data" as invalid for 3GPP access
                  until the UE is switched off or the entry is updated.
                </p>
            </div>
            <div class="custom-text-block">
                <p>T<sub>2</sub>: In case of SNPN, if the UE is not performing 
                  initial registration for onboarding services in SNPN and
                  the UE supports access to an SNPN using credentials
                  from a credentials holder, the UE shall consider the
                  selected entry of the "list of subscriber data" as invalid
                  for 3GPP access until the UE is switched off, the entry
                  is updated or the timer T3245 expires as described in clause5.3.19a.2.
                </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End Timer expiry as a precondition -->


<!-- Unutilized service attempt counter -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">10. Unutilized Service Attempt Counter</h2>
        <div class="content has-text-justified">
          <p>
            <b>Finding:</b> We observe that the service request attempt counter is less utilized compared
            to the registration attempt or tracking area update attempt counter for similar events.
            When a registration attempt is rejected with proper cause value, the counter is reset, but for many
            service_reject the service attempt counter is completely ignored in the description.
            This may potentially cause interoperability among different vendor implementations.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End Unutilized service attempt counter -->


<!-- PDCP counter set -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">11. PDCP Counter Set</h2>
        <div class="content has-text-justified">
          <p>
            <b>Finding:</b> We observed that for the protection of RRC messages while transitioning
            away from RRC_INACTIVE to RRC_CONNECTED, UE derives a set of keys such as K<sub>RRCint</sub>, K<sub>RRCenc</sub>, 
            and so on. However, despite having similar actions of key deriving for connection resume in CM-IDLE,
            the UE additionally resets the PDCP count to 0 and activates new AS keys in PDCP layer. This final 
            action is totally skipped in the first case (Fig 13).
          </p>
          <div class="custom-box">
            <div class="custom-text-block">
                <p>T<sub>1</sub>: For protection of all RRC messages except 
                  RRCReject message following the sent RRCResumeRequest message, 
                  the UE shall derive a K<sub>NG−RAN</sub><sup>*</sup> using the target PCI, target ARFCN-DL/EARFCN-DL
                  and the KgNB/NH based on either a horizontal key derivation or
                  a vertical key derivation as defined in clause 6.9.2.1.1 and Annex
                  A.11/Annex A.12. The UE shall further derive K<sub>RRCint</sub>, K<sub>RRCenc</sub>,
                  K<sub>UPenc</sub> (optionally), and K<sub>UPint</sub> (optionally) from the newly derived K<sub>NG−RAN</sub><sup>*</sup>.
                </p>
            </div>
            <div class="custom-text-block">
                <p>T<sub>2</sub>: For protection of all RRC messages except RRC Reject message
                  following the sent RRC Resume Request message, the UE shall
                  derive a K<sub>NG−RAN</sub><sup>*</sup> using the target PCI, target EARFCN-DL and the
                  KgNB/NH based on either a horizontal key derivation or a vertical
                  key derivation as defined in clause 6.9.2.1.1 and Annex A.12. The UE
                  shall further derive K<sub>RRCint</sub>, K<sub>RRCenc</sub>,
                  K<sub>UPenc</sub> (optionally), and K<sub>UPint</sub> (optionally) 
                  from the newly derived K<sub>NG−RAN</sub><sup>*</sup>. Then the UE resets
                  all PDCP COUNTs to 0 and activates the new AS keys in PDCP layer.
                </p>
            </div>
          </div>
          <p>
            <b>Impact:</b> This subtle miss can have a significant de-synchronization impact if the 
            COTS implementation considers one of them ignoring the other.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End PDCP counter set -->


<!-- Image carousel -->
<!-- <section class="hero is-small">
  <div class="hero-body">
    <div class="container">
      <div id="results-carousel" class="carousel results-carousel">
       <div class="item">
        <img src="static/images/carousel1.jpg" alt="MY ALT TEXT"/>
        <h2 class="subtitle has-text-centered">
          First image description.
        </h2>
      </div>
      <div class="item">
        <img src="static/images/carousel2.jpg" alt="MY ALT TEXT"/>
        <h2 class="subtitle has-text-centered">
          Second image description.
        </h2>
      </div>
      <div class="item">
        <img src="static/images/carousel3.jpg" alt="MY ALT TEXT"/>
        <h2 class="subtitle has-text-centered">
         Third image description.
       </h2>
     </div>
     <div class="item">
      <img src="static/images/carousel4.jpg" alt="MY ALT TEXT"/>
      <h2 class="subtitle has-text-centered">
        Fourth image description.
      </h2>
    </div>
  </div>
</div>
</div>
</section> -->
<!-- End image carousel -->




<!-- Youtube video -->
<!-- <section class="hero is-small is-light">
  <div class="hero-body">
    <div class="container">
      <h2 class="title is-3">Video Presentation</h2>
      <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
          
          <div class="publication-video">
            <iframe src="https://www.youtube.com/embed/JkaxUblCGz0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
          </div>
        </div>
      </div>
    </div>
  </div>
</section> -->
<!-- End youtube video -->


<!-- Video carousel -->
<!-- <section class="hero is-small">
  <div class="hero-body">
    <div class="container">
      <h2 class="title is-3">Another Carousel</h2>
      <div id="results-carousel" class="carousel results-carousel">
        <div class="item item-video1">
          <video poster="" id="video1" autoplay controls muted loop height="100%">
            <source src="static/videos/carousel1.mp4"
            type="video/mp4">
          </video>
        </div>
        <div class="item item-video2">
          <video poster="" id="video2" autoplay controls muted loop height="100%">
            <source src="static/videos/carousel2.mp4"
            type="video/mp4">
          </video>
        </div>
        <div class="item item-video3">
          <video poster="" id="video3" autoplay controls muted loop height="100%">\
            <source src="static/videos/carousel3.mp4"
            type="video/mp4">
          </video>
        </div>
      </div>
    </div>
  </div>
</section> -->
<!-- End video carousel -->






<!-- Paper poster -->
<!-- <section class="hero is-small is-light">
  <div class="hero-body">
    <div class="container">
      <h2 class="title">Poster</h2>

      <iframe  src="static/pdfs/sample.pdf" width="100%" height="550">
          </iframe>
        
      </div>
    </div>
  </section> -->
<!--End paper poster -->


<!--BibTex citation -->
  <section class="section" id="BibTeX">
    <div class="container is-max-desktop content">
      <h2 class="title">BibTeX</h2>
      <pre><code>@inproceedings {298168,
author = {Mirza Masfiqur Rahman and Imtiaz Karim and Elisa Bertino},
title = {{CellularLint}: A Systematic Approach to Identify Inconsistent Behavior in Cellular Network Specifications},
booktitle = {33rd USENIX Security Symposium (USENIX Security 24)},
year = {2024},
isbn = {978-1-939133-44-1},
address = {Philadelphia, PA},
pages = {5215--5232},
url = {https://www.usenix.org/conference/usenixsecurity24/presentation/rahman},
publisher = {USENIX Association},
month = aug
}</code></pre>
    </div>
</section>
<!--End BibTex citation -->

<!--Acknowledgement -->
  <section class="section" id="Acknowledgement">
    <div class="container is-max-desktop content">
      <h2 class="title">Acknowledgement</h2>
      <p>This work is supported by U.S. National Science Foundation AI Institute for Future Edge Networks and Distributed Intelligence (<b>NSF AI EDGE Institute</b>).</p>
      <div class="item">
        <img src="static/images/AI_EDGE_Logo_transparent_New.png" alt="NSF AI EDGE"/>
        <!--<h2 class="subtitle has-text-centered"-->
          NSF AI EDGE Institute
        </h2>-->
      </div>
    </div>
</section>
<!--End Acknowledgement -->


  <footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">

          <p>
            This page was built using the <a href="https://github.com/eliahuhorwitz/Academic-project-page-template" target="_blank">Academic Project Page Template</a> which was adopted from the <a href="https://nerfies.github.io" target="_blank">Nerfies</a> project page.
            You are free to borrow the of this website, we just ask that you link back to this page in the footer. <br> This website is licensed under a <a rel="license"  href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>

        </div>
      </div>
    </div>
  </div>
</footer>

<!-- Statcounter tracking code -->
  
<!-- You can add a tracker to track page visits by creating an account at statcounter.com -->

    <!-- End of Statcounter Code -->

  </body>
  </html>
